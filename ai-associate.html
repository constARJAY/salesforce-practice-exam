<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce AI Associate Certification - Practice Exam</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <style>
        :root {
            --number-todo: whitesmoke;
            --number-active: rgb(94, 146, 205);
            --number-correct: rgb(102, 197, 122);
            --number-wrong: rgb(228, 122, 122);
            --number-for-review: rgb(224, 228, 122);
            --number-current: rgb(167, 176, 187);
        }
        html, * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }
        .question-content {
            background-color: #e9ecef;
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 10px;
            min-height: 200px;
            height: auto;
            max-height: 500px;
            overflow-y: auto;
        }
        .question-numbers {
            flex-wrap: wrap;
            /* padding-bottom: 10px; */
        }
        .question-number {
            border: 1px solid black;
            background-color: var(--number-todo);
            /* min-width: 30px; */
            width: 35px;
            text-align: center;
            cursor: pointer;
            /* padding: 2px 5px; */
            height: 100%;
        }
        .question-number.active, .box.active {
            background-color: var(--number-active);
        }
        .question-number.correct, .box.correct {
            background-color: var(--number-correct);
        }
        .question-number.wrong, .box.wrong {
            background-color: var(--number-wrong);
        }
        .question-number.for-review, .box.for-review {
            background-color: var(--number-for-review);
        }
        .question-number.current, .box.current {
            background-color: var(--number-current);
        }
        .box {
            border: 1px solid gray;
            width: 20px;
            height: 20px;
        }
        .questions {
            font-size: 1.1rem;
        }
        .answer {
            font-weight: bold;
        }
        input.choice {
            height: 15px;
            width: 20px;
        }
        .bg-wrong {
            background-color: var(--number-wrong);
        }
        .bg-correct {
            background-color: var(--number-correct);
        }
        .bg-for-review {
            background-color: var(--number-for-review);
        }
        .explanation {
            font-weight: bold;
            font-style: italic;
        }
        .font-weight-bold {
            font-weight: bold !important;
        }
        .result {
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <main class="container mt-4 px-5">
        <section class="title-timer">
            <div class="d-flex justify-content-between align-items-center" style="font-weight: bold; font-size: 1.8rem;">
                <div class="title text-uppercase">Salesforce AI Associate Certification - Practice Exam</div>
            </div>
        </section>
        <hr>
        <!-- <section class="instructions">
            <div class="d-flex flex-column gap-2 py-2 px-3 bg-light jumbotron">
                <div>
                    <h5 class="font-weight-bold mb-0">Instructions:</h5>
                    <span>Please answer the following questions to the best of your ability.</span>
                </div>
                <div>
                    <h5 class="font-weight-bold mb-0">Time Limit:</h5>
                    <span>90 minutes</span>
                </div>

                <div>
                    <h5 class="font-weight-bold mb-0">Number of Questions:</h5>
                    <span>65</span>
                </div>
                <div>
                    <h5 class="font-weight-bold mb-0">Passing Score:</h5>
                    <span>65%</span>
                </div>
                <div>
                    <h5 class="font-weight-bold mb-0">Show Each Answer?</h5>
                    <input type="checkbox" name="show-answers" id="show-answers" class="">
                </div>
                <div>
                    <button class="btn btn-primary" id="btn-start">Start</button>
                </div>
            </div>
        </section> -->
        <section class="section-numbers">
            <div class="row">
                <div class="col-12 px-3 pt-2">
                    <div class="content numbers row h-100">
                        <div class="col-12 pt-2">
                            <div class="question-numbers d-flex justify-content-start align-items-center gap-1" id="question-numbers">
                                <!-- <div class="question-number active">1</div>
                                <div class="question-number correct">2</div>
                                <div class="question-number">3</div>
                                <div class="question-number">4</div>
                                <div class="question-number">5</div>
                                <div class="question-number">6</div>
                                <div class="question-number">7</div>
                                <div class="question-number">8</div>
                                <div class="question-number">9</div>
                                <div class="question-number">10</div>
                                <div class="question-number">11</div>
                                <div class="question-number">12</div>
                                <div class="question-number">13</div>
                                <div class="question-number">14</div>
                                <div class="question-number">15</div>
                                <div class="question-number">16</div>
                                <div class="question-number">17</div>
                                <div class="question-number">18</div>
                                <div class="question-number">19</div>
                                <div class="question-number">20</div>
                                <div class="question-number">21</div>
                                <div class="question-number">22</div>
                                <div class="question-number">23</div>
                                <div class="question-number">24</div>
                                <div class="question-number">25</div>
                                <div class="question-number">26</div>
                                <div class="question-number">27</div>
                                <div class="question-number">28</div>
                                <div class="question-number">29</div>
                                <div class="question-number">30</div>
                                <div class="question-number">31</div>
                                <div class="question-number">32</div>
                                <div class="question-number">33</div>
                                <div class="question-number">34</div>
                                <div class="question-number">35</div>
                                <div class="question-number">36</div>
                                <div class="question-number">37</div>
                                <div class="question-number">38</div>
                                <div class="question-number">39</div>
                                <div class="question-number">40</div>
                                <div class="question-number">41</div>
                                <div class="question-number">42</div>
                                <div class="question-number">43</div>
                                <div class="question-number">44</div>
                                <div class="question-number">45</div>
                                <div class="question-number">46</div>
                                <div class="question-number">47</div>
                                <div class="question-number">48</div>
                                <div class="question-number">49</div>
                                <div class="question-number">50</div>
                                <div class="question-number">51</div>
                                <div class="question-number">52</div>
                                <div class="question-number">53</div>
                                <div class="question-number">54</div>
                                <div class="question-number">55</div>
                                <div class="question-number">56</div>
                                <div class="question-number">57</div>
                                <div class="question-number">58</div>
                                <div class="question-number">59</div>
                                <div class="question-number">60</div>
                                <div class="question-number">61</div>
                                <div class="question-number">62</div>
                                <div class="question-number">63</div>
                                <div class="question-number wrong">64</div>
                                <div class="question-number for-review">65</div> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 pt-3">
                    <div class="d-flex justify-content-start align-items-center gap-2 flex-wrap">
                        <div class="d-flex justify-content-start gap-2 align-items-center">
                            <div class="box todo">&nbsp;</div>
                            <label for="">UNANSWERED</label>
                        </div>
                        <div class="d-flex justify-content-start gap-2 align-items-center">
                            <div class="box active">&nbsp;</div>
                            <label for="">ANSWERED</label>
                        </div>
                        <div class="d-flex justify-content-start gap-2 align-items-center">
                            <div class="box correct">&nbsp;</div>
                            <label for="">CORRECT</label>
                        </div>
                        <div class="d-flex justify-content-start gap-2 align-items-center">
                            <div class="box wrong">&nbsp;</div>
                            <label for="">INCORRECT</label>
                        </div>
                        <div class="d-flex justify-content-start gap-2 align-items-center">
                            <div class="box for-review">&nbsp;</div>
                            <label for="">FOR REVIEW</label>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="section-questions mt-3">
            <div class="result" id="exam-result-header"></div>
            <div class="questions row" id="questions">
                <div class="content col-12">
                    <p class="question">1. Lorem ipsum dolor, sit amet consectetur adipisicing elit. Harum ex enim, delectus sunt ipsam sint deleniti! Amet non repellat, necessitatibus, facilis iusto deleniti sed rerum, odio quae officiis ad vero? <b>Choose 2 anwers.</b></p>
                    <hr>
                    <div class="choices">
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="checkbox" class="choice" name="choice" id="choice1" checked><span class="px-2 answer">A. Option 1</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="checkbox" class="choice" name="choice" id="choice2"><span class="px-2">B. Option 2</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="checkbox" class="choice" name="choice" id="choice3"><span class="px-2">C. Option 3</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="checkbox" class="choice" name="choice" id="choice4"><span class="px-2">D. Option 4</span></label>
                        </div>
                    </div>
                    <div class="remarks">
                        <hr><p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Sed a quis provident asperiores voluptas hic quisquam fugit modi nesciunt tempora aliquid voluptate nulla voluptatum pariatur unde, animi impedit atque natus.</p>
                    </div>
                </div>
                <div class="content col-12">
                    <p class="question">1. Lorem ipsum dolor, sit amet consectetur adipisicing elit. Harum ex enim, delectus sunt ipsam sint deleniti! Amet non repellat, necessitatibus, facilis iusto deleniti sed rerum, odio quae officiis ad vero? <b>Choose 2 anwers.</b></p>
                    <hr>
                    <div class="choices">
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="radio" class="choice" name="choice" id="choice1"><span class="px-2">A. Option 1</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="radio" class="choice" name="choice" id="choice2"><span class="px-2">B. Option 2</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="radio" class="choice" name="choice" id="choice3"><span class="px-2">C. Option 3</span></label>
                        </div>
                        <div class="choice d-flex align-items-center justify-content-start">
                            <label for=""><input type="radio" class="choice" name="choice" id="choice4"><span class="px-2">D. Option 4</span></label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="result" id="exam-result-footer"></div>
        </section>
        <section class="section-buttons">
            <div class="row my-3">
                <div class="col-12 pb-3">
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" id="progress-bar"></div>
                    </div>
                </div>
                <div class="col-12 text-end gap-2">
                    <div class="d-flex justify-content-end align-items-center gap-2">
                        <button class="btn btn-warning" id="btn-review">MARK AS FOR REVIEW</button>
                        <button class="btn btn-outline-primary" id="btn-previous" disabled>PREVIOUS</button>
                        <button class="btn btn-primary" id="btn-next">NEXT</button>
                    </div>
                    <div class="d-flex justify-content-end align-items-center mt-2 gap-2">
                        <button class="btn btn-info" id="btn-check">CHECK</button>
                        <button class="btn btn-success" id="btn-submit">SUBMIT</button>
                    </div>
                </div>
            </div>
        </section>
    </main>


    <script>
        const QUESTION_LIMIT = 65;
        const PASSING_SCORE_PERCENTAGE = 70;
        let questionList = [];
        let answerList = [];
        
        function getQuestionAnswers() {
            return new Promise((resolve, reject) => {
                $.ajax({
                    url: "ai-associate.json",
                    dataType: "json",
                    success: function(response) {
                        resolve(response);
                        questionList = response.questions || [];
                        answerList = response.answers || [];
                    },
                    error: function(error) {
                        reject(error);
                    }
                });
            });
        }
        getQuestionAnswers();

        function displayQuestionNumbers() {
            let html = '';
            for (let i = 1; i <= QUESTION_LIMIT; i++) {
                let current = i == 1 ? 'current' : '';
                html += `<div class="question-number ${current}" id="question-number${i}" number="${i}">${i}</div>`;
            }
            $("#question-numbers").html(html);
        }

        function displayExamQuestions(data) {
            displayQuestionNumbers();

            let questions = data.questions || [];
            let answers = data.answers || [];

            let randomQuestions = questions.sort(() => Math.random() - 0.5).slice(0, QUESTION_LIMIT);
            let html = '';

            for (let i = 0; i < randomQuestions.length; i++) {
                let { id, question, choices } = randomQuestions[i];
                let questionNumber = i + 1;

                choices = choices.sort(() => Math.random() - 0.5);
                let choicesHTML = '';
                choices.forEach((choice, index) => {
                    let { id: choiceId, value: choiceValue } = choice;
                    choicesHTML += `
                    <div class="parent-choice d-flex align-items-center justify-content-start" id="parent-choice${id + choiceId}" question-id="${id}">
                        <label for="">
                            <input type="radio" class="choice" question-id="${id}" name="choice${id}" id="choice${id + choiceId}" value="${choiceId}" question-number="${questionNumber}">
                            <span class="px-2">${choiceValue}</span>
                        </label>
                    </div>`;
                })

                let display = i === 0 ? 'd-block' : 'd-none';
                html += `
                <div class="question-content col-12 ${display}" id="question-content${questionNumber}" question-id="${id}">
                    <p class="question"><span class="font-weight-bold">${questionNumber}.</span> ${question}</p>
                    <hr>
                    <div class="choices">
                        ${choicesHTML}
                    </div>
                    <div class="remarks"></div>
                </div>`;
            }

            $("#questions").html(html);
        }

        function getUserAnswers() {
            let answers = [];
            $(".choice:checked").each(function() {
                let questionId = $(this).attr("question-id");
                let choiceId = $(this).val();
                answers.push({ questionId, choiceId });
            });
            return answers;
        }

        function checkExamAnswers(data) {
            let answers = data.answers || [];
            let userAnswers = getUserAnswers();

            // Reset all classes
            $('.parent-choice').removeClass("bg-correct").removeClass("bg-wrong").removeClass('bg-for-review');

            let score = 0;
            for (let i = 0; i < answers.length; i++) {
                let { id, value, explanation } = answers[i];
                let userAnswer = userAnswers?.find(answer => answer?.questionId == id);
                let isCorrect = false;

                let correctChoiceId = `#parent-choice${id}${value}`;
                let userChoiceId = `#parent-choice${id}${userAnswer?.choiceId}`;

                if (userAnswer && userAnswer.choiceId == value) {
                    score++;
                    isCorrect = true;
                }

                if (!userAnswer) {
                    $(correctChoiceId).addClass("bg-for-review");
                }
                else if (isCorrect) {
                    $(correctChoiceId).addClass("bg-correct");
                } 
                else {
                    $(userChoiceId).addClass("bg-wrong");
                    $(correctChoiceId).addClass("bg-correct");
                }

                let remarks = `<hr><p class="explanation">${explanation}</p>`;
                $(`#question-content${id} .remarks`).html(remarks);
            }

            let percentage = (score / QUESTION_LIMIT) * 100;
                percentage = percentage.toFixed(2);
            let passingPercentage = 70;
            let status = percentage >= passingPercentage ? "Passed" : "Failed";
            let statusClass = status == "Passed" ? "alert-success" : "alert-danger";

            let resultHTML = `
            <div class="alert ${statusClass} mt-3">
                <h5 class="card-title">${status} ${percentage}%</h5>
                <p class="card-text">
                    <b>Result: </b>
                    <span>${score} / ${QUESTION_LIMIT}</span>
                </p>
            </div>`;
            $("#exam-result-header, #exam-result-footer").html(resultHTML);
        }

        $(document).ready(function() {
            let qna = getQuestionAnswers();
            qna.then((data) => {
                displayExamQuestions(data);
            }).catch((error) => {
                alert("Error: " + error);
                console.log(error);
            });

            function checkSpecificQuestion(questionNumber) {
                let questionId = $('#question-content' + questionNumber).attr("question-id");
                let choiceId = $('[name="choice' + questionId + '"]:checked').val();

                let questionAnswer = answerList.find(answer => answer.id == questionId);
                let isCorrect = questionAnswer && questionAnswer.value == choiceId;

                // Reset all classes
                $(`.parent-choice[question-id=${questionId}]`).removeClass("bg-correct").removeClass("bg-wrong").removeClass('bg-for-review');

                if (!choiceId) {
                    $(`#parent-choice${questionId}${questionAnswer.value}`).removeClass("bg-correct").removeClass("bg-wrong").addClass("bg-for-review");
                }
                else if (isCorrect) {
                    $(`#parent-choice${questionId}${choiceId}`).removeClass("bg-wrong").removeClass("bg-for-review").addClass("bg-correct");
                } 
                else {
                    $(`#parent-choice${questionId}${choiceId}`).removeClass("bg-correct").removeClass("bg-for-review").addClass("bg-wrong");
                    $(`#parent-choice${questionId}${questionAnswer.value}`).removeClass("bg-for-review").removeClass("bg-wrong").addClass("bg-correct");
                }

                let numberBackground = isCorrect ? "correct" : "wrong";
                $(`.question-number[number=${questionNumber}]`).removeClass("active").removeClass('correct').removeClass('wrong').removeClass('for-review').addClass(numberBackground);

                let { explanation } = questionAnswer;
                let remarks = `<hr><p class="explanation">${explanation}</p>`;
                $(`#question-content${questionNumber} .remarks`).html(remarks);

                updateProgressBar();
                return isCorrect;
            }

            function updatePrevNextButton() {
                let currentQuestionNumber = $('.question-number.current').attr("number") || 1;
                    currentQuestionNumber = Number(currentQuestionNumber);
                if (currentQuestionNumber == 1) {
                    $('#btn-previous').attr("disabled", true);
                } else {
                    $('#btn-previous').attr("disabled", false);
                }

                if (currentQuestionNumber == QUESTION_LIMIT) {
                    $('#btn-next').attr("disabled", true);
                } else {
                    $('#btn-next').attr("disabled", false);
                }
            }
            updatePrevNextButton();

            function updateProgressBar() {
                let answeredQuestions = $('.question-number.correct, .question-number.wrong, .question-number.active').length;
                console.log(answeredQuestions);
                let progress = (answeredQuestions / QUESTION_LIMIT) * 100;
                $('#progress-bar').css("width", progress + "%");
            }
            updateProgressBar();

            // Click on question number
            $(document).on("click", ".question-number", function() {
                let questionNumber = $(this).attr("number");
                $(".question-number").removeClass("current");
                $(this).addClass("current");
                $('#questions .question-content').removeClass("d-block").addClass("d-none");
                let content = `#question-content${questionNumber}`;
                $(content).removeClass("d-none").addClass("d-block");
            });

            // Check current question
            $(document).on("click", "#btn-check", function() {
                let questionNumber = $('.question-number.current').attr("number");
                checkSpecificQuestion(questionNumber);
            });

            // Select answer
            $(document).on("click", ".choice", function() {
                let questionId = $(this).attr("question-id");
                let questionNumber = $(this).attr("question-number");
                let choice = $(`.choice[question-id=${questionId}]`).val();
                if (choice) {
                    $('.question-number[number=' + questionNumber + ']').addClass("active");
                }
                updateProgressBar();
            });

            // Mark for review
            $(document).on("click", "#btn-review", function() {
                let currentQuestionNumber = $('.question-number.current').attr("number");
                alert("Question " + currentQuestionNumber + " marked for review");
                $(`.question-number[number=${currentQuestionNumber}]`).addClass("for-review");
            })

            // Next question
            $(document).on("click", "#btn-next", function() {
                let currentQuestionNumber = $('.question-number.current').attr("number");
                let nextQuestionNumber = Number(currentQuestionNumber) + 1;
                if (nextQuestionNumber <= QUESTION_LIMIT) {
                    $('.question-number[number=' + currentQuestionNumber + ']').removeClass("current");
                    $('.question-number[number=' + nextQuestionNumber + ']').addClass("current");
                    $('#questions .question-content').removeClass("d-block").addClass("d-none");
                    let content = `#question-content${nextQuestionNumber}`;
                    $(content).removeClass("d-none").addClass("d-block");
                }
                updatePrevNextButton();
            })

            // Previous question
            $(document).on("click", "#btn-previous", function() {
                let currentQuestionNumber = $('.question-number.current').attr("number");
                let previousQuestionNumber = Number(currentQuestionNumber) - 1;
                if (previousQuestionNumber >= 1) {
                    $('.question-number[number=' + currentQuestionNumber + ']').removeClass("current");
                    $('.question-number[number=' + previousQuestionNumber + ']').addClass("current");
                    $('#questions .question-content').removeClass("d-block").addClass("d-none");
                    let content = `#question-content${previousQuestionNumber}`;
                    $(content).removeClass("d-none").addClass("d-block");
                }
                updatePrevNextButton();
            })

            // Submit
            $(document).on("click", "#btn-submit", function() {
                alert("You have submitted the exam");
                let score = 0;
                for (let i = 1; i <= QUESTION_LIMIT; i++) {
                    let isCorrect = checkSpecificQuestion(i);
                    
                    if (isCorrect) score++;
    
                    let percentage = (score / QUESTION_LIMIT) * 100;
                        percentage = percentage.toFixed(2);
                    let status = percentage >= PASSING_SCORE_PERCENTAGE ? "Passed" : "Failed";
                    let statusClass = status == "Passed" ? "alert-success" : "alert-danger";

                    let resultHTML = `
                    <div class="alert ${statusClass} mt-3">
                        <h5 class="card-title">${status} ${percentage}%</h5>
                        <p class="card-text">
                            <b>Result: </b>
                            <span>${score} / ${QUESTION_LIMIT}</span>
                        </p>
                    </div>`;
                    $("#exam-result-header, #exam-result-footer").html(resultHTML);
                }
                updateProgressBar();
            });
        })
    </script>
</body>
</html>